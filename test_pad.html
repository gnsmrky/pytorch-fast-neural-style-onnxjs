<html>
<title>PyTorch fast-neural-style running in web browser</title>

<script src="https://cdn.jsdelivr.net/npm/onnxjs@0.1.4/dist/onnx.min.js"></script>

<body>
ONNX.js <b>reflection pad</b> op test.

<script>
    const sess = new onnx.InferenceSession({backendHint: 'webgl'});

    sess.loadModel("./onnx_models/test_pad_zero_128x128.onnx").then(()=>{
    
        const n = 3;
        const h = 128;
        const w = 128;

        const x = new Float32Array(1*n*h*w);

        for (i=0; i<1*n*h*w; i++) {
            x[i] = (i%256) / 255.0;
        }

        const inputT = new onnx.Tensor(x, 'float32', [1,n,h,w]);

        sess.run([inputT]).then(output=>{
            const outputT = output.values().next().value;

            //console.log(`model output tensor: ${outputT.data}.`);
            console.log(`model output tensor size: ${outputT.size}`);
            
            const newLine = "<br/>";//String.fromCharCode(13, 10);
            logOutput.innerHTML = "test 17" + newLine;

            var i;
            for (var i=0; i<8; i++) {
                logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;
            }

            for (var j=0; j<8; j++) {
                const i = j + h*w/2;
                logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;
            }
        });
    });
</script>

<div id='logOutput'></div>

</body>
</html>

