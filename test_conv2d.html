<html>
<title>PyTorch fast-neural-style running in web browser</title>

<script src="https://cdn.jsdelivr.net/npm/onnxjs@0.1.4/dist/onnx.min.js"></script>

<body>
ONNX.js <b>instance_norm</b> op test.

<script>
    const sess = new onnx.InferenceSession({backendHint: 'webgl'});

    sess.loadModel("./onnx_models/test_pad_128x128.onnx").then(()=>{
    
        const n = 3;
        const x = new Float32Array(1*n*128*128);

        for (i=0; i<1*n*128*128; i++) {
            x[i] = (i%256) / 255.0;
        }

        const inputT = new onnx.Tensor(x, 'float32', [1,n,128,128]);

        sess.run([inputT]).then(output=>{
            const outputT = output.values().next().value;

            //console.log(`model output tensor: ${outputT.data}.`);
            console.log(`model output tensor size: ${outputT.size}`);
            
            const newLine = "<br/>";//String.fromCharCode(13, 10);
            logOutput.innerHTML = "test 17" + newLine;

            var i=0;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;

            /*
            var i=1*n*h*w-8;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            logOutput.innerHTML += "data[" + i + "]: " + outputT.data[i] + newLine;  i++;
            */
        });
    });
</script>

<div id='logOutput'></div>

</body>
</html>

